<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Forum Topic Keyman 9 and Windows 8.1 issues - Tavultesoft</title>

<style media='print' type='text/css'> 
	@import "../inc/style9.css";
  @import "../inc/print.css";
  	#global_nav, #header_nav { display: none }
  .screen_only { display: none }
</style>
<style media="screen" type="text/css">
	@import "../inc/style9.css";
	@import "../inc/layout8.css";
  	#global_nav, #header_nav { display: none }
  .print_only { display: none }
  
  #getstartedlink { font-weight: bold; color: #ad4a28; }
</style>
<!--[if lt IE 8]><style type='text/css'>#menu_search { display: none !important; }</style><![endif]-->
<![if gt IE 7]><style type='text/css'>#menu_search_ie { display: none !important; }</style><![endif]><style media='all' type='text/css'>
              #banner {display: none} 
              #mainColumn {width: 100%} 
          </style><style media='all' type='text/css'> 
              #localnav {display: none} 
              #mainColumn {width: 100%} 
          </style><!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="/inc/ie6.css" /> 
<![endif]--> 
<script type='text/javascript'><!--
  function detect_screen_width()
  {
    var w;
    if(typeof(screen.availWidth) != 'undefined') w = screen.availWidth; else w = screen.width;
    if(w && w < 1024) document.writeln("<style media='screen' type='text/css'> #banner { display: none; } #footer, #container, #tavultesoft_logo { width: auto } #home_subColumn { width: 235px }<\/style>");
  }
  detect_screen_width();
//--></script>
<script type='text/javascript'><!--
startList = function() {
	if (document.all&&document.getElementById) {
		navRoot = document.getElementById("nav");
		for (i=0; i<navRoot.childNodes.length; i++) {
			node = navRoot.childNodes[i]; 
			if (node.nodeName=="LI") {
				node.onmouseover=function() {
					this.className+=" over";
				}
				node.onmouseout=function() {
          this.className=this.className.replace(/ over/g, "");
				}
			}
		}
	}
}
window.onload=startList;
//--></script>
</head>
<body>  <div id="container">
    <div id="pagelocation"></div>
    <div id="tavultesoft_logo"><a href='http://tavultesoft.com/' id='tavultesoft_banner'></a>
      
      
    </div>
		
    <div id="content">
    		<div id="mainColumn">
          <div id="breadcrumbsandlogininfo">
    	 	    <div class="breadcrumbsandlogininfo_content">
              <div id="breadcrumbs"><a href='http://tavultesoft.com/'>Home</a> &gt; <a href='index.html'>Forums</a> &gt; <a href='category.php@forumcategoryid=7.html'>Bugs and Features</a> &gt; <a href='topic.php@forumtopicid=356.html'>Keyman 9 and Windows 8.1 issues</a></div><div id="logininfo"></div><div id="breadcrumbs_breaker">&nbsp;</div></div></div><div class='mainColumn_content' id='mainColumn_content'><h1>Topic Keyman 9 and Windows 8.1 issues</h1><p>We have two new locations for Keyman technical support:</p>
<ul>
  <li><a href='https://community.software.sil.org/c/keyman'>SIL Keyman Community</a> - for general Keyman technical support</li>
  <li><a href='http://stackoverflow.com/questions/ask?tags=keyboard,unicode'>Stack Overflow</a> - for support on creating keyboard layouts with Keyman Developer</li>
</ul>
<p>The Tavultesoft Forums are now read only.</p>
<hr><p class='forumnav' style='font-size: x-small'>&laquo; First Page&nbsp;|&nbsp;&lsaquo; Previous 10&nbsp;|&nbsp;<a href='topic.php@forumtopicid=356&amp;start=10.html'>Next 10 &rsaquo;</a>&nbsp;|&nbsp;<a href='topic.php@forumtopicid=356&amp;start=10.html'>Last Page &raquo;</a></p><table class='forums display'><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1193.html#ForumPost_1193'>#</a></span><a style='text-decoration:none' name='ForumPost_1193'></a> Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-06 18:29:34.980</span></th></tr><tr id='forumpost_1193'><td class='nickname' width='25%'>Stephen K<br /></td><td class='text' width='75%'><div class='text'>Hello. 
<br />
   I wanted to report some issues I&#039;m having with Keyman 9. I have previously used keyman 8 lite, primarily for use in Word and Flex. I am running windows 8.1. After upgrading to keyman 9, I&#039;m having a number of issues. 
<br />

<br />
  For one, it seems that any windows hotkeys I setup to change languages are disabled. I can only switch languages with the windows key + spacebar. For example, I set windows to use Lalt + shift (in the windows keyboard advanced settings), which worked in keyman 8, but not longer is working in keyman 9.
<br />
 
<br />
  In addition to this, there are some other issues with language switching. I am using 2 keyboards in addition to my normal English keyboard (UTB and IPA). When I use windows key + spacebar to switch languages, the first time it correctly switches to my 2nd keyboard. But when I click it again to go to the third keyboard, it <span style="font-style: italic">does </span>actually switch to that 3rd keyboard, but graphically, the popup shows it returning back to my default english keyboard. It seems like there is some disconnect between what the windows language bar is displaying and what keyman is displaying. Or is there a reason why keyman would not switch keyboards when I switch languages? Could it have something to do with the fact that my default language is English, and I&#039;m also using English for one of my keyman keyboards?
<br />
 
<br />
 Additionally, keyman 9 does not seem to be properly integrating with Flex. Previously, one could assign a keyboard language and keyman layout for each writing system in Flex, but now Flex does not recognize any keyman keyboards. I can manually use the keyboards in Flex, but Flex does not automatically utilize certain keyman keyboards with certain writing systems like it did previously. Is Keyman 9 incompatible with Flex currently?
<br />
  
<br />
 Another thing I have noticed is that most of the time, when I change languages using the windows language bar, usually the appropriate keyman keyboard will activate. However, in some contexts, it does not. For example, when using Google Chrome, switching languages in the windows language bar fails to activate the appropriate keyman keyboard. Is there a reason for this? 
<br />
 
<br />
 I hope this feedback helps. If I can give any additional input, please just let me know. </div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1197.html#ForumPost_1197'>#</a></span><a style='text-decoration:none' name='ForumPost_1197'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-07 18:40:03.640</span></th></tr><tr id='forumpost_1197'><td class='nickname' width='25%'>Marc Durdin<br />Tavultesoft Staff</td><td class='text' width='75%'><div class='text'>Stephen,
<br />

<br />
Thank you for the detailed feedback -- would you mind sending through a diagnostic report for your computer (the diagnostic tool can be downloaded from <a href="http://help.keyman.com/kb/40" target="_blank">http://help.keyman.com/kb/40</a>) so we can correlate your experiences with your computer&#039;s configuration?
<br />

<br />
We&#039;ll go through and test the different scenarios you describe here and let you know what we find in the next few days (I am at home sick at present so may be a little delayed).
<br />

<br />
Best,
<br />

<br />
Marc</div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1199.html#ForumPost_1199'>#</a></span><a style='text-decoration:none' name='ForumPost_1199'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-07 19:28:38.387</span></th></tr><tr id='forumpost_1199'><td class='nickname' width='25%'>Stephen K<br /></td><td class='text' width='75%'><div class='text'>Thanks for your prompt reply Marc. 
<br />

<br />
I have submitted the diagnostic report as you requested. I noticed that when accessing the diagnostic tool from Keyman 9, the &#039;send diagnostic report&#039; button is missing, but I was able to download the standalone diagnostic tool and that worked just fine. </div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1200.html#ForumPost_1200'>#</a></span><a style='text-decoration:none' name='ForumPost_1200'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-07 23:08:45.250</span></th></tr><tr id='forumpost_1200'><td class='nickname' width='25%'>Stephen K<br /></td><td class='text' width='75%'><div class='text'>After a couple of re-installs and updating Flex, things seem to be working a bit better. The latest version of Flex seems to now recognize my keyman keyboards in the Writing systems setup.
<br />

<br />
I am also able to switch to my keyman keyboards while in Google Chrome.
<br />

<br />
During the process of reinstalling, I tried to revert to Keyman 8 but ran into serious problems. It would only install the french version (without giving me an option) and all of the menus were blank, so it was completely unusable.  </div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1201.html#ForumPost_1201'>#</a></span><a style='text-decoration:none' name='ForumPost_1201'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-08 08:23:00.883</span></th></tr><tr id='forumpost_1201'><td class='nickname' width='25%'>Marc Durdin<br />Tavultesoft Staff</td><td class='text' width='75%'><div class='text'>Stephen, thanks for the update.  We have had one other report of the version 8 install showing blank screens and we were unsure what the problem was.
<br />

<br />
However, I have just had an idea what may be causing this.  Keyman 9 asks the Internet Explorer renderer to put the screens into IE9 standards-compliant mode, which is far better than the hodgepodge that IE6 gave us (which Keyman 8 had to support).  However, this probably breaks the Keyman 8 configuration screen.
<br />

<br />
<span style="font-weight: bold">Update:</span> See <a href="http://help.keyman.com/kb/85" target="_blank">http://help.keyman.com/kb/85</a> for a downloadable utility that will fix this issue.
<br />

<br />
The following steps require you to access the Windows Registry with a technical tool. You should backup your computer before proceeding, and we cannot take responsibility for use of this tool.
<br />

<br />
To resolve this, you&#039;ll need to delete the registry values &quot;keyman.exe&quot; and &quot;kmshell.exe&quot; in the following key:
<br />

<br />
HKCU\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION
<br />

<br />
Step-by-step:
<br />

<br />
1. Click start, type regedit and press Enter.
<br />
2. When the Registry Editor appears, navigate in the tree down through HKEY_CURRENT_USER (right arrow to expand each tree node), to Software, Microsoft, Internet Explorer, Main, FeatureControl, FEATURE_BROWSER_EMULATION.
<br />
3. In the right hand pane, highlight the entries &quot;keyman.exe&quot; and &quot;kmshell.exe&quot;, and press Del to delete.
<br />

<br />
There may also be an entry under FEATURE_NATIVE_DOCUMENT_MODE for kmshell.exe.  If so, delete that kmshell.exe value as well.</div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1202.html#ForumPost_1202'>#</a></span><a style='text-decoration:none' name='ForumPost_1202'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-08 17:36:05.163</span></th></tr><tr id='forumpost_1202'><td class='nickname' width='25%'>Stephen K<br /></td><td class='text' width='75%'><div class='text'>Thanks Marc. That worked like a charm! That let me revert to Keyman 8 without any problems. 
<br />

<br />
I had a suspicion that the registry had something to do with it. I don&#039;t have much experience with it, but had tried to use cccleaner to look for any leftovers of Keyman, but the entries for keyman.exe and kmshell.exe hadn&#039;t shown up. 
<br />

<br />
Thanks again!</div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1203.html#ForumPost_1203'>#</a></span><a style='text-decoration:none' name='ForumPost_1203'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-09 07:31:01.203</span></th></tr><tr id='forumpost_1203'><td class='nickname' width='25%'>Marc Durdin<br />Tavultesoft Staff</td><td class='text' width='75%'><div class='text'>Stephen, that&#039;s good news.
<br />

<br />
For others who experience the same issue, we&#039;ve turned the instructions into a knowledge base article at <a href="http://help.keyman.com/kb/85" target="_blank">http://help.keyman.com/kb/85</a> and included a downloadable utility that will make that correction automatically.</div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1204.html#ForumPost_1204'>#</a></span><a style='text-decoration:none' name='ForumPost_1204'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-09 07:32:55.673</span></th></tr><tr id='forumpost_1204'><td class='nickname' width='25%'>Marc Durdin<br />Tavultesoft Staff</td><td class='text' width='75%'><div class='text'>I&#039;m not sure where you are at now in terms of Keyman 9 -- you indicated that a number of the issues were resolved when you reinstalled, but I&#039;d like to be clear on what is still outstanding?</div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1208.html#ForumPost_1208'>#</a></span><a style='text-decoration:none' name='ForumPost_1208'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-09 23:03:30.727</span></th></tr><tr id='forumpost_1208'><td class='nickname' width='25%'>Stephen K<br /></td><td class='text' width='75%'><div class='text'>Currently it seems like all of the issues I had with Keyman 9 are now resolved. There are a couple of quirks when using Flex still (see below).
<br />

<br />
The issue with switching windows keyboards seems to be resolved. I can now cycle through my 3 keyboards properly without any problems.
<br />

<br />
It seems that my issues with Flex are mostly resolved. I am now able to assign a specific keyboard to a specific writing system. I&#039;m not sure if everything is working perfectly though. Occasionally I will have to click twice in a certain field before the correct keyboard will turn on for that writing system. A collegue using Keyman 9 was saying that occasionally the spacebar would become unusable in certain Flex fields with the UTB keyboard turned on. But I haven&#039;t spent enough time to see if these things are happening regularly. If I notice more Flex specific issues, I&#039;ll try to provide more feedback.  
<br />

<br />
Finally, the Keyman keyboards seem to be properly activating when using any program, including Chrome.
<br />

<br />
So, basically everything is working as I would expect, but if I notice more Flex specific issues, I&#039;ll try to provide more feedback later.</div></td></tr><tr><th colspan='2'><span class='quote'><a href='topic.php@forumtopicid=356&amp;forumpostid=1209.html#ForumPost_1209'>#</a></span><a style='text-decoration:none' name='ForumPost_1209'></a> RE: Keyman 9 and Windows 8.1 issues &nbsp; <span class='date'>2014-10-10 14:46:59.867</span></th></tr><tr id='forumpost_1209'><td class='nickname' width='25%'>Marc Durdin<br />Tavultesoft Staff</td><td class='text' width='75%'><div class='text'>Thanks for the follow up. Glad to hear things are working much better for you. Looking forward to hearing anything you find regarding Flex.</div></td></tr></table><p class='forumnav' style='font-size: x-small'>&laquo; First Page&nbsp;|&nbsp;&lsaquo; Previous 10&nbsp;|&nbsp;<a href='topic.php@forumtopicid=356&amp;start=10.html'>Next 10 &rsaquo;</a>&nbsp;|&nbsp;<a href='topic.php@forumtopicid=356&amp;start=10.html'>Last Page &raquo;</a></p></p>